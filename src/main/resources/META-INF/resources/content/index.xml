<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MyCoReWebPage>
<MyCoReWebPage>

  <section xml:lang="de" title="Willkommen bei der PHTG">
    <div class="jumbotwo" id="phtg-index-search" style="margin-top:50px;">
      <div class="row">
        <div class="col-lg-10 offset-lg-1 col-xl-8 offset-xl-2" lang="de">
          <h1>
            Publikationsserver der PHTG
          </h1>
          <form
            id="project-searchMainPage"
            class="form-inline mt-3 justify-content-center"
            action="../servlets/solr/find"
            role="search">
            <div class="input-group w-100">
              <input
                name="condQuery"
                placeholder="Suche in 16.000 Dokumenten"
                class="form-control search-query"
                id="project-searchInput"
                type="text"
                aria-label=""
                aria-describedby="" />
              <div class="input-group-append">
                <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i></button>
              </div>
            </div>
            <div class="custom-control custom-switch mt-3">
              <input type="checkbox" class="custom-control-input" id="switchPaper" />
              <label class="custom-control-label" for="switchPaper">Referate einbeziehen</label>
            </div>
            <div class="custom-control custom-switch mt-3 ml-4">
              <input type="checkbox" class="custom-control-input" id="switchThesis" />
              <label class="custom-control-label" for="switchThesis">Qualifikationsarbeiten einbeziehen</label>
            </div>
          </form>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="../js/jquery.number.js"></script>
    <script>
      $( document ).ready(function() {
        var documentsAll = 0;
        var documentsFiltered = 0;
        $.ajax({
          type: "GET",
          url: '../api/v1/search?q=objectType:mods AND state:published AND NOT(category.top:"mir_genres:speech") AND NOT(category.top:"mir_genres:thesis")&amp;rows=0&amp;wt=json&amp;json.wrf=?',
          dataType: "jsonp",
          success: function (data) {
            documentsFiltered = $.number(data.response.numFound,0, ',', '.');
            if ( documentsFiltered ) {
              $('#project-searchInput').attr('placeholder', 'Suche in ' + documentsFiltered + ' Dokumenten');
            }

          },
        });
        $.ajax({
          type: "GET",
          url: "../api/v1/search?q=objectType:mods AND state:published&amp;rows=0&amp;wt=json&amp;json.wrf=?",
          dataType: "jsonp",
          success: function (data) {
            documentsAll = $.number(data.response.numFound,0, ',', '.');
          },
        });
        var paperFilter = '<input name="fq" type="hidden" value="NOT(category.top:&quot;mir_genres:speech&quot;)" id="filterPaper" />';
        $("#project-searchMainPage").append( paperFilter );

        $("#switchPaper").change(function() {
          if ( $("#switchPaper").prop("checked") === true ) {
            $("#filterPaper").remove();
            if ( documentsAll ) {
              $('#project-searchInput').attr('placeholder', 'Suche in ' + documentsAll + ' Dokumenten');
            }
          } else {
            $("#project-searchMainPage").append( paperFilter );
            if ( documentsFiltered ) {
              $('#project-searchInput').attr('placeholder', 'Suche in ' + documentsFiltered + ' Dokumenten');
            }
          }
        });

      var thesisFilter = '<input name="fq" type="hidden" value="NOT(category.top:&quot;mir_genres:thesis&quot;)" id="filterThesis" />';
      $("#project-searchMainPage").append( thesisFilter );

      $("#switchThesis").change(function() {
        if ( $("#switchThesis").prop("checked") === true ) {
          $("#filterThesis").remove();
          if ( documentsAll ) {
            $('#project-searchInput').attr('placeholder', 'Suche in ' + documentsAll + ' Dokumenten');
          }
        } else {
          $("#project-searchMainPage").append( thesisFilter );
          if ( documentsFiltered ) {
            $('#project-searchInput').attr('placeholder', 'Suche in ' + documentsFiltered + ' Dokumenten');
          }
        }
      });

      });
    </script>
  </section>
  <meta>
  </meta>
</MyCoReWebPage>
